@model List<Business.Models.PinnedPhotoDTO>
@{
    ViewBag.Title = "SAVED PHOTOS";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h5>SAVED PHOTOS</h5>
<div class="saved-photos-link">
    @Html.ActionLink("BACK TO SEARCH PANEL", "Index", "PhotoSearch")
</div>    

@for (int i = 0; i < Model.Count; i++)
{
    var annotations = string.Join(",", @Model[i].Annotations.Select(s => s.Tag));
    <div class="pinned-photo-container">
        <div class="pinned-photo">
            <input type="hidden" name="photoId">
            <img src="@Model[i].Url"/>
        </div>
        <input id="annotations-@Model[i].ID" type="text" name="annotations" value="@annotations" data-role="tagsinput" />
        <div class="save-annotation">
            <a onclick="saveAnnotations(@Model[i].ID)"><img src="../images/edit-icon.png"/></a>
        </div>
    </div>
}

<script>
    function saveAnnotations(id) {
        debugger;
        var annotations = $('#annotations-' + id).val();

        var data = { photoId: id, annotations: annotations };

        $.ajax({
            type: "POST",
            url: '@Url.Action("SaveAnnotations", "PinnedPhotos")',
            data: data,
            error: function (XMLHttpRequest, textStatus, errorThrown) {
                alert('Error while saving');
            },
            complete: function (jqXHR, status) {
                alert('Saved successful');
            }
        });
    }
</script>